#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -U -v -r -f bwa-par.sh -o bwa-par 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\351"
#define      pswd_z	256
#define      pswd	((&data[40]))
	"\001\074\341\302\151\254\271\051\014\150\124\021\220\053\202\306"
	"\206\040\301\204\131\117\175\241\103\110\101\330\126\334\056\127"
	"\030\017\031\201\274\323\253\370\123\307\111\117\014\017\310\375"
	"\201\260\213\337\101\146\264\000\032\200\123\121\116\250\264\146"
	"\123\343\033\301\371\104\271\115\013\003\235\027\023\145\024\224"
	"\025\237\164\126\006\050\126\041\251\252\162\370\123\046\136\246"
	"\012\172\150\004\276\042\122\312\045\357\342\071\124\367\316\152"
	"\227\102\301\236\152\030\277\024\302\061\014\026\130\152\275\143"
	"\345\045\147\244\107\271\156\155\250\121\247\375\111\165\147\340"
	"\267\050\176\042\101\076\067\003\157\103\032\310\256\327\053\223"
	"\374\222\067\104\114\246\261\365\370\131\362\101\316\132\041\206"
	"\203\240\251\304\336\340\310\116\043\342\026\321\271\101\144\266"
	"\324\234\372\040\103\254\026\073\005\010\174\324\143\235\132\346"
	"\075\003\253\034\344\163\152\007\126\200\331\020\301\076\306\225"
	"\332\301\266\035\156\314\130\163\325\324\110\071\162\243\040\260"
	"\247\313\314\213\076\066\222\225\267\154\245\170\252\153\016\205"
	"\055\305\242\233\221\373\017\147\320\127\240\103\372\300\363\241"
	"\213\300\054\312\367\277\137\256\053\005\047\326\160\066\133\235"
	"\373\375\071\215\371\110\364\310\073\000\331\313\053\133\222\261"
	"\173\124\065\324\243\263\166\347\373\270\300\122"
#define      chk1_z	22
#define      chk1	((&data[322]))
	"\254\376\303\056\272\302\135\035\253\370\347\371\063\243\346\373"
	"\014\314\154\012\107\243\344\267\252\141\075\226\331\202"
#define      text_z	4614
#define      text	((&data[1329]))
	"\236\005\267\061\266\063\205\354\007\051\237\176\020\233\066\320"
	"\355\312\277\227\167\276\133\246\171\362\200\374\305\132\130\143"
	"\137\017\224\026\102\032\002\112\103\242\311\124\075\377\044\053"
	"\312\344\303\101\243\036\350\034\020\150\030\325\302\160\071\042"
	"\200\316\070\303\351\072\015\054\334\327\200\032\326\245\106\241"
	"\212\011\342\055\050\313\111\071\063\141\017\366\322\111\030\122"
	"\027\120\025\000\213\043\055\150\372\256\202\321\123\311\162\335"
	"\323\125\012\373\041\124\065\124\266\104\113\210\216\144\332\245"
	"\265\360\246\100\024\324\250\017\202\053\341\326\365\124\264\310"
	"\252\277\304\313\023\371\040\311\076\153\121\314\317\054\162\204"
	"\035\031\305\062\356\156\102\161\232\043\107\217\167\373\127\041"
	"\273\033\354\316\025\014\230\124\170\352\041\110\027\224\314\064"
	"\255\222\147\234\000\251\015\232\314\124\051\104\120\201\146\013"
	"\235\123\332\262\140\163\006\330\135\047\040\164\273\355\251\151"
	"\177\020\005\200\272\023\033\207\147\105\313\270\306\062\304\143"
	"\205\237\025\345\022\034\276\157\104\336\344\000\313\215\152\113"
	"\236\160\313\131\203\347\340\353\054\254\243\362\336\150\125\143"
	"\007\153\111\031\210\007\211\314\346\155\315\262\373\067\375\231"
	"\247\311\362\053\260\323\026\334\177\271\317\135\042\045\301\051"
	"\221\013\102\031\022\313\346\371\071\263\253\064\353\250\315\222"
	"\162\300\275\043\224\324\000\023\216\317\161\260\364\063\331\205"
	"\076\034\237\121\350\205\112\041\070\365\125\043\236\043\266\021"
	"\344\164\064\170\110\064\214\326\003\375\207\370\061\140\176\160"
	"\175\036\301\145\243\014\206\334\002\333\000\241\376\267\262\342"
	"\053\346\132\164\032\347\113\036\344\322\027\026\063\226\206\260"
	"\264\110\025\127\124\233\064\127\166\064\370\165\353\252\130\027"
	"\220\263\213\253\232\326\311\176\251\341\224\334\167\033\215\053"
	"\143\242\203\267\076\267\016\265\353\007\052\326\261\202\355\101"
	"\065\171\354\317\120\266\116\371\227\343\326\016\376\144\072\142"
	"\007\275\031\105\164\050\372\137\057\045\066\340\247\044\042\335"
	"\235\017\255\355\305\374\347\135\340\276\154\337\042\246\101\052"
	"\143\133\157\327\204\152\067\263\217\155\224\067\221\267\025\057"
	"\307\302\034\214\277\004\352\237\303\126\176\346\375\300\020\140"
	"\033\177\070\237\351\157\123\171\335\350\260\156\237\305\235\146"
	"\210\272\363\107\277\336\346\202\064\145\151\062\045\171\222\101"
	"\371\312\340\342\072\063\133\027\034\014\206\273\321\044\042\131"
	"\337\026\240\237\364\207\041\051\355\213\133\022\004\355\123\375"
	"\270\064\340\363\150\074\012\204\110\221\100\032\266\142\163\225"
	"\170\024\064\155\233\126\226\211\341\361\233\346\337\357\344\227"
	"\044\304\213\214\001\226\021\111\047\121\143\335\264\327\163\055"
	"\353\247\232\207\376\061\020\340\042\254\306\001\234\252\231\301"
	"\157\044\115\160\272\137\271\342\261\035\300\146\365\063\223\341"
	"\333\056\151\331\137\172\271\201\047\200\203\303\052\035\204\231"
	"\101\322\012\374\062\303\337\343\341\237\111\327\323\335\270\257"
	"\013\041\210\152\233\102\354\302\303\160\206\356\215\013\207\317"
	"\336\221\314\020\125\253\363\067\113\075\016\037\032\307\316\045"
	"\350\127\220\204\232\175\107\135\355\315\113\173\331\323\112\267"
	"\145\026\307\272\301\273\362\015\370\001\054\022\310\372\070\260"
	"\122\310\065\354\106\174\111\063\112\224\256\043\150\371\332\315"
	"\017\242\210\321\135\172\337\125\173\013\147\104\006\237\365\130"
	"\150\052\105\256\246\216\342\361\043\221\025\213\213\360\130\232"
	"\222\340\154\357\133\113\105\327\127\255\033\136\115\020\267\265"
	"\072\374\144\341\212\107\323\255\331\350\071\144\330\222\377\153"
	"\162\153\133\316\267\240\245\016\115\300\155\232\321\044\120\013"
	"\040\265\355\252\375\300\130\327\251\222\074\201\044\073\355\227"
	"\247\110\145\137\350\012\156\066\313\333\321\234\377\042\250\037"
	"\330\225\312\325\126\043\255\000\265\351\201\331\044\157\160\314"
	"\267\326\053\237\340\231\326\253\164\247\110\164\312\360\224\242"
	"\206\136\170\334\202\045\335\067\016\137\021\063\316\202\377\205"
	"\130\052\045\071\304\373\344\071\242\054\256\155\035\102\017\243"
	"\240\207\200\042\254\135\132\272\274\154\355\212\356\355\017\107"
	"\030\064\200\335\057\145\000\276\307\131\005\205\200\304\004\314"
	"\377\050\057\101\221\054\173\120\324\131\375\306\252\342\302\166"
	"\353\312\265\032\111\331\054\235\241\116\320\266\124\103\176\232"
	"\140\344\036\154\201\331\002\234\106\113\034\013\243\243\116\123"
	"\113\230\222\331\255\212\277\162\164\072\214\363\152\373\052\367"
	"\255\061\055\211\374\042\331\364\337\215\054\042\371\044\012\357"
	"\234\322\312\365\150\362\104\164\170\370\210\064\276\125\032\225"
	"\133\161\016\270\364\117\315\021\066\220\110\312\226\107\205\123"
	"\144\060\014\325\262\140\135\206\271\106\132\330\214\362\060\076"
	"\312\255\312\246\250\227\021\101\305\057\210\043\002\354\233\030"
	"\253\047\111\271\277\007\057\002\034\317\275\141\360\230\360\350"
	"\121\247\225\203\034\154\026\334\337\007\214\377\351\013\040\270"
	"\271\210\372\233\215\361\354\316\047\336\133\233\211\370\343\315"
	"\310\136\052\064\072\370\260\260\141\251\114\001\366\376\264\136"
	"\275\231\353\251\007\355\067\003\272\023\121\253\305\154\376\005"
	"\246\127\317\113\153\225\026\155\021\376\322\332\013\070\131\324"
	"\327\050\344\134\050\227\262\327\061\263\053\120\103\023\362\237"
	"\355\105\337\272\007\160\024\335\231\253\055\350\107\002\057\167"
	"\306\223\146\100\223\022\124\157\213\332\145\000\265\047\055\367"
	"\162\200\147\002\002\012\361\074\075\314\257\342\322\055\312\341"
	"\102\017\342\351\062\370\133\153\262\115\252\100\014\035\152\021"
	"\117\114\361\015\060\313\270\116\067\364\107\103\256\007\251\072"
	"\320\130\272\313\231\037\235\143\307\233\323\077\131\024\317\176"
	"\124\037\216\244\267\057\144\263\035\066\331\334\114\002\353\144"
	"\271\276\156\034\043\027\164\264\210\162\326\054\373\203\157\042"
	"\234\127\207\165\013\344\317\124\142\173\123\044\117\013\257\147"
	"\047\310\154\244\332\031\243\171\123\203\370\303\005\204\054\245"
	"\322\332\047\360\203\223\001\307\001\154\214\147\116\354\171\341"
	"\252\324\040\153\227\153\122\232\136\040\054\226\104\202\315\244"
	"\351\007\115\044\156\307\311\144\375\356\215\036\071\143\232\141"
	"\124\014\171\017\363\151\237\007\063\257\106\062\043\126\061\051"
	"\253\124\132\100\051\333\253\377\351\377\346\115\164\235\020\173"
	"\057\030\355\355\212\101\127\110\157\045\103\010\244\122\310\347"
	"\040\336\153\130\374\123\143\324\034\347\066\255\032\356\015\051"
	"\270\131\213\305\305\171\356\356\143\343\137\150\147\225\060\043"
	"\074\305\260\231\361\207\043\330\166\306\051\270\145\320\101\231"
	"\340\276\216\344\000\140\151\057\211\211\062\135\311\243\056\127"
	"\013\331\315\101\172\153\326\156\262\044\020\226\342\021\331\352"
	"\356\262\063\210\140\160\035\343\247\251\152\375\314\202\047\017"
	"\361\301\244\040\255\042\051\230\035\355\214\030\342\354\176\255"
	"\275\206\357\371\014\325\022\015\160\216\356\073\342\246\264\160"
	"\061\000\330\267\012\257\071\217\110\011\057\311\351\145\167\362"
	"\201\307\322\213\200\341\164\162\316\220\270\076\172\137\061\263"
	"\257\324\117\354\210\346\342\265\076\061\032\063\067\072\371\273"
	"\077\056\174\303\106\324\252\314\040\226\121\034\200\357\107\116"
	"\265\177\265\135\044\160\153\135\307\217\356\352\350\001\077\157"
	"\044\053\032\302\242\262\050\114\035\345\302\017\375\063\040\337"
	"\317\072\070\247\255\265\022\204\317\070\276\251\165\045\125\221"
	"\320\016\104\215\100\271\326\002\243\053\374\323\131\142\121\377"
	"\370\300\002\304\264\230\061\166\227\160\023\046\314\351\027\232"
	"\263\124\373\011\144\121\352\051\162\077\027\375\165\260\047\245"
	"\251\111\122\276\375\042\242\324\103\013\247\022\364\325\327\366"
	"\334\100\171\051\301\045\374\021\277\054\112\024\236\347\076\266"
	"\361\361\106\234\225\363\235\004\310\155\267\254\330\022\002\025"
	"\074\244\223\325\165\365\003\256\272\343\311\345\213\377\372\216"
	"\330\363\171\354\157\302\176\201\171\220\003\370\142\377\304\113"
	"\000\025\275\353\025\245\353\111\147\263\347\332\111\356\226\324"
	"\157\065\350\257\043\121\356\376\344\044\325\305\373\053\200\112"
	"\247\243\170\143\000\326\271\156\335\314\240\353\160\241\103\141"
	"\022\145\252\102\215\243\202\227\332\244\155\011\240\206\264\331"
	"\173\102\074\040\301\011\061\326\251\272\321\233\201\060\122\127"
	"\063\060\123\233\132\037\030\021\340\131\273\252\004\211\146\246"
	"\110\003\070\147\341\357\000\213\255\111\221\324\321\015\133\120"
	"\207\050\340\272\153\355\125\067\310\375\241\064\071\313\032\311"
	"\272\252\063\003\267\004\322\152\124\203\157\200\145\225\225\364"
	"\367\226\167\220\275\344\314\141\315\260\157\322\276\015\216\106"
	"\302\022\160\156\237\342\136\251\004\321\374\330\112\012\150\356"
	"\250\001\216\157\067\252\377\324\300\362\157\135\316\147\251\003"
	"\341\145\244\150\343\240\116\277\103\073\206\153\007\041\373\144"
	"\162\127\136\021\333\072\164\067\134\072\101\230\111\260\001\047"
	"\077\066\313\372\221\051\175\305\175\062\357\370\156\254\332\351"
	"\173\224\121\361\217\223\061\160\376\111\171\130\157\162\035\126"
	"\077\114\177\266\345\022\363\000\214\251\367\113\143\365\030\344"
	"\350\213\103\346\163\367\022\341\366\370\076\034\025\045\240\041"
	"\155\246\137\012\235\213\277\142\365\300\175\241\335\305\107\172"
	"\335\123\107\024\332\115\064\202\163\200\167\115\372\335\232\052"
	"\253\253\110\076\263\004\144\076\267\365\007\022\136\026\131\023"
	"\121\175\133\232\271\036\367\104\371\137\332\264\125\156\203\325"
	"\261\044\237\015\010\145\131\327\140\207\212\332\272\206\204\155"
	"\173\312\307\376\346\003\065\345\241\101\073\243\231\315\156\332"
	"\323\026\205\066\102\174\207\050\004\136\144\031\245\037\314\033"
	"\256\320\262\221\070\310\126\330\160\372\344\023\315\063\263\153"
	"\275\046\376\103\047\234\114\035\006\376\127\322\320\071\070\115"
	"\045\357\353\067\220\160\175\155\323\362\377\211\221\007\112\202"
	"\307\355\007\344\277\064\006\332\044\147\352\230\140\153\144\024"
	"\122\343\321\355\135\330\335\316\211\323\067\105\237\067\111\317"
	"\162\016\110\261\276\170\266\061\367\064\016\303\152\153\363\076"
	"\314\244\034\123\135\116\170\357\322\330\366\007\101\017\040\171"
	"\107\321\036\215\161\326\366\360\301\162\153\121\343\275\207\002"
	"\224\134\232\041\210\164\024\316\361\330\217\170\007\026\170\231"
	"\137\376\014\344\154\212\126\073\267\013\067\204\216\075\152\307"
	"\304\061\306\125\143\320\376\140\062\327\355\322\273\316\147\210"
	"\305\306\247\166\227\130\107\142\165\107\050\022\133\146\075\111"
	"\231\265\176\233\115\015\205\253\377\041\203\136\001\376\232\204"
	"\223\015\002\220\073\076\056\336\124\042\215\237\164\310\362\344"
	"\172\372\203\041\274\062\222\100\361\126\262\076\330\303\344\055"
	"\131\352\255\145\252\375\361\056\001\005\163\133\272\303\071\333"
	"\246\261\205\052\331\052\102\155\062\012\263\146\354\201\172\332"
	"\265\151\235\174\243\215\116\144\145\050\212\210\376\373\123\133"
	"\341\013\036\326\273\375\104\275\037\342\304\052\304\301\312\122"
	"\372\176\060\176\113\316\230\021\205\013\123\223\064\216\030\037"
	"\253\362\267\342\161\270\275\071\156\362\056\346\144\217\142\334"
	"\212\374\230\312\231\055\113\313\002\006\377\371\037\037\347\124"
	"\237\013\147\303\225\346\347\264\062\146\336\343\105\023\204\265"
	"\151\163\077\353\104\072\027\121\110\103\152\074\047\114\314\152"
	"\253\367\170\274\313\370\073\044\255\135\136\054\016\376\131\044"
	"\227\003\365\357\266\075\246\263\206\262\260\076\330\135\256\362"
	"\362\166\021\107\132\225\025\150\155\206\276\206\053\005\126\043"
	"\147\365\017\350\254\213\005\211\205\333\100\131\177\166\270\210"
	"\056\134\137\000\034\324\215\023\344\324\004\312\162\133\345\126"
	"\176\343\314\230\143\306\015\252\034\013\005\376\346\343\300\041"
	"\131\217\276\203\101\315\042\307\244\124\254\172\014\143\267\166"
	"\327\116\270\023\144\335\332\114\324\071\201\040\256\307\254\212"
	"\215\250\205\203\067\273\225\367\213\167\070\201\101\070\222\173"
	"\266\046\123\344\166\022\350\253\176\353\112\231\333\135\342\364"
	"\061\063\136\073\357\006\044\362\373\200\300\347\107\005\145\163"
	"\000\064\306\151\213\063\065\152\041\365\153\376\335\340\141\063"
	"\130\155\112\056\010\167\325\124\322\145\231\174\213\272\306\037"
	"\247\141\354\215\163\137\332\353\341\370\127\366\334\322\361\313"
	"\145\173\105\021\007\243\120\345\176\051\334\020\315\006\012\256"
	"\013\010\025\061\273\300\272\327\317\006\335\172\025\160\026\304"
	"\033\360\205\016\062\312\072\061\037\027\243\334\252\265\226\025"
	"\155\203\153\210\054\200\355\137\116\143\254\244\315\200\065\155"
	"\101\010\065\124\114\015\374\263\275\257\242\177\310\031\024\074"
	"\065\161\067\356\256\172\013\220\032\006\370\161\147\331\335\006"
	"\016\365\143\120\012\200\052\265\060\042\337\352\217\126\226\055"
	"\006\361\371\025\272\317\075\025\376\133\344\272\120\124\025\001"
	"\176\226\327\167\162\102\242\176\316\015\173\221\237\357\062\244"
	"\025\133\156\137\120\222\314\351\312\272\040\105\152\156\211\010"
	"\157\231\340\073\130\054\350\306\035\241\026\030\227\230\173\332"
	"\062\351\325\141\012\017\327\065\214\062\116\307\150\076\215\224"
	"\136\316\363\241\131\026\063\112\303\162\306\365\230\017\071\160"
	"\044\344\170\041\210\154\103\157\323\065\111\202\070\122\331\024"
	"\347\066\201\116\277\064\222\237\014\377\264\000\323\121\341\027"
	"\212\003\172\034\105\335\172\202\011\136\364\123\323\245\347\117"
	"\154\001\264\162\105\151\115\103\267\127\230\010\302\346\055\166"
	"\272\361\013\071\324\027\150\323\211\053\245\031\215\306\271\251"
	"\275\222\147\155\042\147\011\076\165\213\277\171\361\167\226\164"
	"\201\306\101\130\316\222\027\364\165\342\347\262\371\233\171\351"
	"\023\103\221\311\345\015\140\066\272\114\023\333\310\345\166\176"
	"\337\104\121\340\344\363\165\316\200\130\370\320\003\263\034\271"
	"\110\041\045\151\230\224\220\300\234\074\201\204\026\255\105\072"
	"\057\126\227\317\267\334\242\307\145\265\056\311\141\310\373\104"
	"\240\111\237\161\214\313\116\312\366\222\036\212\262\353\005\150"
	"\111\072\302\075\123\076\107\223\043\166\102\277\031\113\055\205"
	"\115\125\310\245\153\250\061\044\117\133\101\200\342\114\316\162"
	"\046\051\134\205\237\157\251\340\136\073\141\327\274\215\011\230"
	"\363\132\226\057\016\246\332\057\017\022\137\127\226\343\121\151"
	"\322\042\227\005\345\335\124\144\042\031\326\173\247\353\242\313"
	"\070\213\111\262\160\367\050\312\023\120\005\175\261\052\053\253"
	"\320\315\173\024\164\172\103\163\255\340\116\027\146\350\313\302"
	"\377\051\142\155\260\212\026\173\376\047\302\131\107\354\021\270"
	"\121\241\352\351\101\303\211\072\345\231\333\344\124\036\304\373"
	"\325\222\054\067\260\361\115\061\072\056\101\342\224\304\347\022"
	"\241\275\115\204\140\332\353\357\053\033\056\147\334\115\334\003"
	"\236\251\102\231\273\257\247\036\215\213\243\110\204\032\032\377"
	"\105\301\107\006\006\026\335\201\262\105\272\102\307\206\172\130"
	"\063\112\333\321\113\317\102\125\316\173\141\211\115\332\171\134"
	"\150\026\074\301\151\122\065\341\053\037\133\066\147\250\037\351"
	"\235\207\346\221\151\250\064\373\344\035\010\143\221\023\210\263"
	"\307\226\134\126\361\254\354\105\165\075\316\121\231\211\210\275"
	"\214\052\133\247\067\063\020\371\027\340\072\027\034\037\204\364"
	"\036\111\101\100\225\373\116\146\032\337\174\172\064\041\171\267"
	"\345\135\044\062\114\131\113\322\066\370\043\353\124\054\315\375"
	"\102\366\041\067\253\035\136\142\226\014\310\014\003\160\353\005"
	"\345\223\012\315\365\225\007\102\047\052\125\305\140\125\122\001"
	"\125\112\357\375\353\236\113\012\210\262\343\013\063\033\117\104"
	"\102\073\321\344\351\220\145\360\062\367\201\223\005\205\007\044"
	"\152\132\064\342\050\102\372\147\053\327\213\243\025\230\313\106"
	"\336\100\115\341\351\315\060\307\304\003\024\243\222\354\250\077"
	"\347\232\136\263\076\273\371\223\035\120\216\113\153\321\055\211"
	"\227\355\151\127\333\343\041\030\217\242\032\352\223\024\242\101"
	"\064\302\027\106\335\055\260\150\274\145\220\130\266\153\367\047"
	"\206\115\116\305\057\143\222\041\217\126\371\345\065\042\166\337"
	"\156\236\000\101\257\010\002\070\164\203\064\157\023\040\247\051"
	"\243\151\364\231\151\376\152\015\127\135\132\257\233\160\210\230"
	"\122\354\376\152\373\317\230\216\335\336\166\171\001\074\254\231"
	"\270\364\072\272\204\073\266\365\246\022\341\314\355\317\337\101"
	"\170\123\052\305\157\270\315\116\107\035\265\320\324\310\061\330"
	"\073\007\301\026\216\334\375\331\142\330\135\201\362\146\122\111"
	"\104\242\144\252\347\107\355\135\157\200\275\162\051\277\012\374"
	"\140\237\367\113\115\056\175\311\054\030\017\172\171\061\205\345"
	"\001\175\332\142\040\126\251\112\321\334\233\071\207\224\224\163"
	"\326\322\025\155\123\010\113\223\256\206\313\107\253\026\335\032"
	"\160\376\277\216\153\117\143\113\300\072\272\340\050\327\364\246"
	"\302\363\067\201\245\263\313\207\276\261\205\066\046\347\303\203"
	"\377\117\313\176\217\273\041\065\344\152\062\211\114\230\022\100"
	"\137\325\135\307\202\077\330\216\064\315\221\234\235\101\070\041"
	"\321\237\062\221\046\160\066\055\316\332\033\275\110\213\276\050"
	"\301\316\323\152\110\235\306\064\005\103\060\125\133\214\304\013"
	"\227\223\110\177\203\064\337\261\275\037\230\153\043\144\322\365"
	"\346\114\255\352\030\312\217\255\163\302\161\010\302\064\337\320"
	"\145\202\011\313\035\352\147\376\226\044\173\160\052\355\055\332"
	"\313\305\146\022\166\205\010\201\237\113\273\311\267\256\123\155"
	"\275\305\304\126\031\175\015\250\032\200\076\201\372\071\205\356"
	"\114\337\057\227\027\203\174\250\260\146\145\014\307\307\174\027"
	"\216\231\350\140\366\206\202\075\076\203\337\266\213\316\207\105"
	"\133\052\165\220\162\240\352\355\054\201\066\270\276\372\103\036"
	"\101\153\113\220\153\300\363\232\170\204\006\206\345\060\041\126"
	"\222\014\026\112\106\163\306\105\205\252\021\211\322\345\161\231"
	"\347\127\224\020\125\033\220\316\315\104\360\050\173\256\363\035"
	"\041\347\325\232\375\340\124\316\101\023\133\323\266\302\314\174"
	"\040\051\054\232\207\121\331\303\360\110\263\015\172\011\032\062"
	"\342\367\266\027\006\303\341\274\122\265\143\062\167\351\055\111"
	"\171\011\135\350\146\303\127\250\031\323\167\311\330\110\343\200"
	"\135\322\342\267\067\244\061\116\332\203\216\324\174\173\212\226"
	"\306\102\265\350\317\346\206\121\167\150\060\372\257\036\172\136"
	"\237\264\074\030\166\230\072\131\253\214\124\020\004\031\135\322"
	"\326\336\215\020\176\350\347\047\032\226\073\136\105\257\302\320"
	"\244\250\115\165\255\346\131\111\207\020\032\371\215\134\121\063"
	"\223\237\070\304\006\275\374\051\235\015\317\054\247\141\073\325"
	"\337\112\165\370\213\364\060\067\171\322\242\167\321\210\077\273"
	"\060\150\077\172\226\010\334\271\346\227\301\000\342\314\127\235"
	"\177\317\304\203\155\216\355\053\213\261\156\155\102\337\341\237"
	"\124\032\064\363\373\154\236\240\156\225\302\357\247\371\332\155"
	"\252\116\374\103\034\364\263\323\153\104\264\153\231\050\377\142"
	"\334\346\113\011\313\136\070\332\020\210\035\345\121\162\136\263"
	"\260\311\032\050\132\220\065\214\044\126\016\344\262\122\266\146"
	"\001\072\157\332\137\313\126\103\110\075\070\227\037\357\333\076"
	"\217\242\234\351\011\212\102\332\272\370\004\342\147\066\020\036"
	"\103\017\353\373\350\220\234\266\257\221\245\221\151\055\140\217"
	"\154\024\242\037\342\304\070\254\125\355\260\173\056\045\121\042"
	"\243\043\232\365\312\356\055\341\001\132\054\120\230\235\066\060"
	"\227\143\057\253\013\012\131\145\101\325\171\042\324\062\245\162"
	"\056\047\124\115\105\152\047\370\070\374\050\063\161\022\340\141"
	"\254\307\065\122\007\355\305\113\233\264\362\211\020\101\350\061"
	"\370\375\076\316\025\101\375\105\052\167\043\265\343\334\255\354"
	"\210\322\142\140\015\165\372\317\057\175\112\066\114\150\306\076"
	"\026\233\156\044\205\310\144\054\305\067\161\246\205\363\157\221"
	"\216\110\031\133\233\066\035\002\072\156\063\365\155\204\357\244"
	"\070\173\170\005\377\277\031\010\246\343\326\112\276\177\042\172"
	"\132\131\301\165\051\260\012\234\322\000\322\175\234\230\216\273"
	"\107\163\360\255\176\337\264\202\371\232\253\163\042\244\077\155"
	"\272\350\045\023\032\250\354\233\377\134\060\016\205\373\303\006"
	"\052\332\314\317\224\221\007\304\144\205\032\210\245\355\206\027"
	"\216\117\045\263\037\267\224\163\060\343\261\023\156\054\307\232"
	"\102\060\012\015\011\340\134\126\156\133\303\163\360\034\026\320"
	"\053\257\311\374\243\166\233\030\113\017\267\171\321\363\075\112"
	"\303\004\160\251\072\342\173\317\375\144\312\214\014\322\327\157"
	"\370\205\004\074\115\371\142\101\151\300\165\071\366\373\274\106"
	"\153\063\240\331\303\046\276\126\044\267\225\031\366\300\031\240"
	"\337\322\117\261\255\177\101\175\310\072\332\351\163\227\340\232"
	"\331\132\115\314\140\267\145\117\311\260\040\202\025\313\240\320"
	"\160\124\304\015\203\165\041\315\255\274\310\337\032\076\005\057"
	"\022\025\366\050\332\342\247\334\363\252\365\064\005\042\154\215"
	"\237\222\055\042\141\042\177\243\032\232\055\025\355\360\060\271"
	"\171\004\142\224\256\252\117\042\350\343\103\162\354\015\275\215"
	"\045\013\135\146\262\176\223\003\121\040\014\116\147\030\222\111"
	"\133\364\307\030\301\023\375\362\075\203\207\162\317\077\350\302"
	"\273\127\254\234\063\072\243\073\112\101\104\155\372\314\135\271"
	"\134\312\312\112\334\335\205\276\243\016\033\002\364\150\213\370"
	"\277\256\003\220\263\371\104\347\367\065\200\002\271\312\042\116"
	"\301\023\007\352\052\134\175\345\316\006\211\230\132\325\131\166"
	"\055\153\324\216\230\056\010\170\276\070\071\373\375\053\057\216"
	"\316\326\042\225\330\061\042\056\327\121\066\371\230\063\343\336"
	"\303\160\377\214\204\255\074\316\153\026\370\226\153\066\302\050"
	"\242\042\212\170\274\133\206\133\313\140\063\232\126\314\106\301"
	"\207\125\244\370\354\322\127\121\340\350\040\102\375\346\057\215"
	"\241\207\163\262\130\117\127\321\011\031\236\236\245\006\336\332"
	"\020\147\250\320\045\074\175\245\053\062\071\336\277\237\142\325"
	"\211\161\253\141\156\024\031\077\141\143\344\270\156\216\301\225"
	"\152\201\133\211\334\373\051\153\334\301\366\115\174\372\023\221"
	"\006\262\001\100\276\356\247\103\006\020\367\116\067\247\313\040"
	"\267\120\166\366\037\104\132\327\274\310\235\064\372\006\261\145"
	"\255\165\071\314\232\007\200\346\005\242\323\272\001\240\231\025"
	"\312\104\054\070\263\037\166\204\152\303\164\002\355\044\162\352"
	"\350\245\034\351\202\050\160\331\122\334\263\222\140\335\133\170"
	"\102\110\254\316\341\336\152\042\266\131\242\227\125\262\374\321"
	"\140\357\137\267\043\362\356\251\255\174\211\211\053\012\300\354"
	"\174\237\122\344\350\376\153\043\120\063\224\124\100\354\304\266"
	"\064\017\117\374\032\060\007\146\266\260\332\231\133\062\164\033"
	"\377\220\046\344\112\055\254\056\150\223\105\351\010\331\131\273"
	"\224\121\257\075\072\010\255\132\177\271\337\000\270\336\100\072"
	"\057\073\203\350\153\265\202\114\111\224\045\042\014\201\245\263"
	"\114\244\224\316\171\217\052\356\332\131\200\243\143\237\266\021"
	"\101\060\112\154\026\177\140\064\354\156\050\060\237\111\137\033"
	"\332\223\023\237\154\105\312\107\117\275\337\113\344\125\141\071"
	"\222\173\256\257\052\133\351\212\360\212\111\334\106\323\121\140"
	"\140\240\365\376\131\034\042\204\146\272\307\242\331\122\131\076"
	"\262\301\074\136\334\372\034\150\233\266\010\137\266\066\243\022"
	"\255\325\077\064\004\237\126\310\303\144\115\355\164\362\355\271"
	"\327\062\232\054\040\065\213\240\140\071\124\272\136\173\364\150"
	"\335\123\050\316\110\143\220\250\111\206\070\117\273\314\160\176"
	"\235\202\314\306\150\347\337\307\245\032\350\051\153\306\060\324"
	"\025\321\020\160\162\155\052\100\225\201\141\344\340\244\344\166"
	"\323\314\101\144\204\006\017\371\041\370\041\113\301\030\071\312"
	"\122\226\166\252\250\163\014\061\153\321\112\233\051\016\124\373"
	"\267\267\035\255\223\154\101\053\231\020\071\043\322\036\023\003"
	"\167\347\303\234\042\370\252\034\020\073\005\155\026\322\221\304"
	"\077\256\007\117\122\247\326\322\312\203\057\045\076\354\221\054"
	"\166\200\031\206\307\062\273\110\017\353\255\046\276\076\352\375"
	"\355\361\115\100\231\044\022\144\247\102\212\345\057\034\022\245"
	"\234\053\054\144\135\347\254\155\322\132\223\220\231\176\216\206"
	"\160\334\307\011\000\331\156\247\034\371\215\113\025\237\361\262"
	"\313\036\026\050\005\303\226\330\035\051\151\266\247\370\075\027"
	"\324\004\041\324\336\220\173\373\211\011\106\237\250\070\121\163"
	"\126\150\234\134\054\062\064\111\134\236\000\003\226\076\033\152"
	"\103\075\077\042\315\272\035\127\304\143\366\154\234\107\337\362"
	"\257\174\117\333\256\203\045\012\042\046\016\270\145\051\043\250"
	"\147\142\312\064\035\347\213\341\113\202\116\347\311\055\332\171"
	"\252\051\125\130\255\173\143\317\241\162\210\007\234\254\257\003"
	"\017\172\070\054\142\303\016\256\106\134\226\017\212\160\211\065"
	"\232\337\216\107\132\361\027\374\144\240\003\000\115\263\003\134"
	"\056\073\211\220\377\227\077\105\364\325\125\177\106\337\264\340"
	"\276\102\050\031\064\100\025\230\341\030\231\056\314\234\212\372"
	"\330\023\213\330\253\312\036\237\240\164\037\346\124\324\306\022"
	"\026\357\053\113\057\101\344\020\132\175\076\046\032\310\041\362"
	"\334\254\313\207\167\352\047\027\136\107\376\262\033\304\305\062"
	"\263\361\175\343\062\141\364\214\336\062\263\370\373\324\353\327"
	"\201\267\137\371\241\207\021\000\316\017\263\351\324\171\033\210"
	"\152\231\153\235\372\137\052\331\222\335\322\215\262\276\145\064"
	"\166\305\056\027\114\077\030\032\117\313\003\043\104\037\253\257"
	"\270\026\115\263\166\167\215\010\125\140\226\010\036\374\075\224"
	"\301\153\254\015\253\304\050\372\220\053\035\324\113\311\204\004"
	"\340\321\270\126\111\105\137\237\245\365\247"
#define      tst2_z	19
#define      tst2	((&data[6362]))
	"\131\263\120\005\172\052\113\141\330\302\174\371\153\157\146\224"
	"\136\347\052\261\020\023\123\300\373\312\350"
#define      chk2_z	19
#define      chk2	((&data[6386]))
	"\024\277\030\256\311\331\216\063\236\274\320\235\002\355\215\061"
	"\207\215\167\373"
#define      date_z	1
#define      date	((&data[6405]))
	"\051"
#define      rlax_z	1
#define      rlax	((&data[6406]))
	"\120"
#define      tst1_z	22
#define      tst1	((&data[6407]))
	"\023\272\126\345\172\125\017\123\074\313\145\134\126\133\131\245"
	"\133\042\353\051\274\073"
#define      msg1_z	65
#define      msg1	((&data[6435]))
	"\156\007\150\026\314\132\275\047\260\313\066\363\350\077\136\013"
	"\035\344\312\324\034\302\073\034\042\265\312\366\355\360\374\045"
	"\345\130\157\340\173\137\305\307\373\100\070\214\106\225\312\027"
	"\243\356\161\227\212\343\300\076\277\335\173\230\024\071\110\126"
	"\176\257\136\041\013\216\324\373\045\015\113\052\316\107"
#define      shll_z	10
#define      shll	((&data[6509]))
	"\116\314\175\253\312\112\230\276\122\013\123\137"
#define      inlo_z	3
#define      inlo	((&data[6519]))
	"\117\220\314"
#define      xecc_z	15
#define      xecc	((&data[6522]))
	"\267\167\361\261\257\177\121\364\042\333\031\034\232\245\104\354"
	"\267"
#define      lsto_z	1
#define      lsto	((&data[6539]))
	"\044"
#define      msg2_z	19
#define      msg2	((&data[6542]))
	"\027\332\141\005\366\370\037\122\116\061\322\026\252\036\305\047"
	"\062\210\363\031\115\012\343\065\005"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */
#define MMAP2		0	/* Define as 1 to use syscall mmap2 */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
#if MMAP2
    Allow(mmap2),       /* also for malloc() */
#else
    Allow(mmap),        /* also for malloc() */
#endif
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
