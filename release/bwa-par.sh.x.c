#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -v -r -f bwa-par.sh -o bwa-par 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[5]))
	"\033\062\076\331\245\336\253\002\065\304\367\023\335\134\370\064"
	"\005\165\331\053\356\150\046\264\014\011\014\277\124\103\301\263"
	"\120\221\070\073\165\030\022\302\246\270\107\242\036\175\201\323"
	"\066\360\051\060\326\235\233\151\213\125\035\306\141\225\122\243"
	"\134\225\172\364\016\137\322\212\351\251\037\354\260\222\233\010"
	"\324\270\054\045"
#define      msg2_z	19
#define      msg2	((&data[87]))
	"\074\273\323\210\045\161\350\325\166\176\343\040\110\376\133\052"
	"\345\156\271\214\101\317\372\176\115"
#define      date_z	1
#define      date	((&data[109]))
	"\055"
#define      shll_z	10
#define      shll	((&data[110]))
	"\173\134\103\250\324\353\170\075\124\115\006"
#define      rlax_z	1
#define      rlax	((&data[121]))
	"\346"
#define      chk1_z	22
#define      chk1	((&data[127]))
	"\205\224\103\040\234\163\310\043\145\005\246\261\155\143\323\123"
	"\066\201\311\243\156\174\305\066\357\222\054\030\331\310\075"
#define      tst1_z	22
#define      tst1	((&data[156]))
	"\300\110\256\300\132\052\000\242\362\324\304\346\023\223\330\045"
	"\346\273\126\355\121\001\301\241\010\272\307\374\314\236"
#define      inlo_z	3
#define      inlo	((&data[183]))
	"\024\260\077"
#define      opts_z	1
#define      opts	((&data[186]))
	"\330"
#define      text_z	4828
#define      text	((&data[868]))
	"\252\100\166\076\203\227\332\233\160\242\331\364\060\265\264\171"
	"\143\156\100\140\073\336\205\064\206\022\064\336\330\305\317\202"
	"\005\105\301\211\334\233\045\115\076\377\101\156\264\365\347\027"
	"\144\050\170\237\006\376\324\215\020\011\153\351\316\072\154\323"
	"\200\055\135\135\310\202\252\006\201\353\165\065\341\135\115\106"
	"\205\306\345\214\304\272\031\324\303\204\275\221\277\052\145\077"
	"\127\302\234\040\105\107\047\306\063\234\374\024\371\112\133\176"
	"\020\100\013\324\373\044\251\276\251\147\117\150\221\265\250\351"
	"\167\104\011\275\214\060\204\277\314\201\324\306\313\057\105\334"
	"\160\120\261\153\164\133\052\035\302\172\206\124\057\056\075\247"
	"\163\107\144\377\167\350\277\104\152\224\013\065\303\120\022\064"
	"\241\304\240\026\037\312\064\342\104\272\066\164\351\164\033\134"
	"\273\200\134\063\151\034\170\323\260\203\010\163\324\033\250\165"
	"\337\110\213\376\022\277\340\127\172\027\313\143\214\347\300\107"
	"\147\034\173\320\071\363\243\351\167\254\135\113\310\005\301\247"
	"\115\115\246\140\015\207\270\207\236\204\353\052\153\253\162\322"
	"\310\356\243\001\342\107\353\131\363\110\245\274\115\146\143\233"
	"\264\012\374\301\221\264\111\057\070\064\132\244\340\315\166\251"
	"\273\032\253\235\141\226\366\125\336\234\021\054\002\165\307\267"
	"\177\303\170\021\167\301\101\260\366\233\124\326\150\313\200\044"
	"\345\053\301\107\302\270\235\240\124\257\314\127\044\224\016\244"
	"\127\207\265\317\110\366\200\077\222\324\025\372\240\226\037\206"
	"\302\340\316\204\230\153\045\355\032\362\104\077\206\123\343\336"
	"\332\230\256\043\217\056\142\041\003\170\034\244\016\073\052\320"
	"\033\370\125\264\144\173\242\176\155\346\276\364\072\241\323\024"
	"\072\201\067\311\260\231\352\264\022\006\130\040\102\203\361\135"
	"\174\107\022\340\302\264\137\057\233\035\044\325\277\367\352\371"
	"\170\042\303\051\274\255\335\316\264\065\357\366\270\340\124\065"
	"\047\147\025\351\034\165\031\267\222\075\215\121\065\167\113\255"
	"\231\016\327\126\274\264\044\160\352\023\147\243\364\274\330\034"
	"\044\355\005\100\143\037\370\365\135\205\107\222\375\222\100\227"
	"\240\027\355\134\314\022\315\266\045\065\131\032\362\062\066\026"
	"\040\074\127\203\133\117\170\270\325\300\113\322\122\213\152\363"
	"\242\127\120\156\152\036\045\217\124\176\252\106\261\340\135\321"
	"\034\264\124\170\004\315\060\331\215\173\254\340\007\026\324\251"
	"\156\045\030\330\103\075\150\227\274\022\336\155\362\073\076\017"
	"\360\223\207\364\140\270\316\355\064\172\316\073\220\242\345\377"
	"\307\375\327\013\073\100\243\367\122\202\145\105\276\244\125\256"
	"\067\334\243\227\225\161\205\311\353\124\005\174\367\353\173\276"
	"\350\123\312\044\223\156\034\346\360\201\054\256\045\201\135\134"
	"\135\001\364\363\162\172\274\136\316\302\333\305\255\127\204\226"
	"\252\117\272\076\275\326\045\256\130\121\135\175\322\272\332\057"
	"\273\317\042\056\111\337\214\030\242\111\322\247\132\003\305\312"
	"\312\327\101\044\132\072\351\217\157\014\231\275\255\144\001\146"
	"\146\304\004\055\075\053\062\360\203\073\021\200\366\241\162\153"
	"\244\155\106\177\046\104\046\134\327\210\253\255\216\363\353\352"
	"\167\005\362\034\131\024\031\271\365\356\346\066\334\331\315\363"
	"\257\314\155\017\100\222\311\113\340\326\173\116\340\220\140\253"
	"\021\260\026\022\033\043\034\107\371\050\371\021\301\126\217\063"
	"\163\113\063\362\223\126\107\056\203\213\276\343\026\322\016\247"
	"\323\070\053\173\142\035\046\323\245\006\062\373\167\164\314\347"
	"\215\113\105\060\151\267\116\236\114\021\117\046\264\045\172\176"
	"\203\154\003\125\006\252\215\157\025\371\046\042\101\137\224\160"
	"\325\021\156\266\153\035\363\133\031\311\225\311\113\045\302\256"
	"\076\350\275\173\061\125\341\255\214\154\107\162\013\041\340\033"
	"\070\066\075\364\202\020\143\242\230\204\327\176\070\111\113\351"
	"\131\206\324\234\310\000\205\276\060\154\240\166\357\134\042\267"
	"\123\311\167\036\062\363\224\217\150\216\304\210\155\075\071\035"
	"\154\151\005\113\340\241\302\210\035\203\254\321\350\247\100\024"
	"\330\174\343\061\332\261\245\312\003\265\271\001\046\236\161\255"
	"\041\123\346\207\170\220\137\110\020\361\161\227\100\300\330\253"
	"\222\243\172\042\175\142\140\346\266\352\257\107\076\101\257\106"
	"\336\250\151\137\277\073\035\375\070\134\303\247\031\366\034\304"
	"\364\012\124\146\061\336\267\305\130\350\237\347\303\157\246\140"
	"\040\243\337\177\212\344\011\043\202\161\042\062\347\204\355\320"
	"\325\271\362\151\312\211\261\241\342\122\062\254\054\074\317\164"
	"\002\227\066\330\265\205\176\240\270\360\056\344\351\041\005\254"
	"\027\176\132\200\040\215\226\171\034\134\304\014\002\011\134\340"
	"\004\202\214\204\362\350\052\272\376\024\367\155\170\036\247\367"
	"\312\147\121\153\367\070\264\311\150\337\343\074\107\361\327\012"
	"\046\032\342\147\235\337\250\226\273\335\347\147\034\155\045\345"
	"\216\264\116\310\311\300\275\210\222\235\053\052\035\151\136\012"
	"\332\156\065\027\127\161\107\235\222\345\037\124\136\140\211\335"
	"\064\026\107\147\236\165\302\122\243\300\121\231\015\240\141\125"
	"\217\026\131\022\117\165\047\373\106\356\306\133\362\074\041\036"
	"\045\310\367\153\165\151\374\202\032\224\237\063\104\217\337\375"
	"\106\375\020\163\026\136\236\037\055\311\223\277\225\040\355\317"
	"\257\311\367\335\165\304\113\277\336\372\214\274\106\304\056\340"
	"\011\263\337\012\231\256\217\007\063\240\301\317\312\101\341\143"
	"\036\345\306\121\134\311\370\234\207\201\250\215\052\245\227\220"
	"\115\013\115\142\211\152\313\064\317\363\266\151\035\266\256\166"
	"\167\262\126\253\046\266\245\267\124\326\206\363\277\041\373\057"
	"\371\305\347\013\015\040\012\162\115\364\334\252\353\262\031\012"
	"\046\136\264\145\131\125\101\072\345\215\277\267\204\071\126\102"
	"\075\261\103\057\170\375\000\177\265\150\150\023\023\251\021\150"
	"\254\210\372\254\052\303\170\257\273\203\031\221\152\360\264\272"
	"\346\262\332\030\067\250\351\365\115\265\254\137\332\241\026\356"
	"\235\371\371\234\250\263\114\216\260\032\234\123\176\176\346\323"
	"\336\362\137\030\024\251\166\263\074\053\242\320\234\327\065\033"
	"\322\227\212\372\234\253\322\300\343\154\071\075\153\042\330\303"
	"\205\167\351\174\017\102\152\012\014\031\016\072\000\026\376\000"
	"\137\362\351\367\106\276\157\032\270\273\120\157\036\123\214\300"
	"\211\325\203\204\247\157\203\216\123\317\233\246\264\231\276\306"
	"\373\345\362\154\376\175\273\176\205\150\162\057\072\102\053\005"
	"\127\333\201\376\247\253\321\371\224\251\215\375\074\262\125\131"
	"\076\325\313\140\134\276\240\070\250\251\110\253\226\165\131\277"
	"\076\064\246\151\043\042\375\326\260\034\023\113\020\043\272\247"
	"\135\261\361\227\323\266\244\370\274\036\135\216\264\216\025\166"
	"\056\156\053\340\130\100\262\121\336\040\266\203\102\370\051\342"
	"\357\133\024\013\326\013\265\033\022\135\257\161\140\235\131\020"
	"\201\033\022\204\203\337\155\217\122\277\261\103\054\237\116\374"
	"\034\320\242\234\205\225\163\001\075\214\310\334\207\114\220\312"
	"\355\212\151\020\051\243\123\102\017\011\144\344\273\352\172\066"
	"\175\221\134\265\105\220\244\317\231\070\345\331\202\252\217\206"
	"\356\040\270\110\025\355\077\310\121\022\071\176\372\372\234\074"
	"\176\250\017\134\014\167\061\041\157\025\312\275\122\073\014\220"
	"\257\150\357\277\156\324\244\354\271\322\126\102\176\263\032\174"
	"\177\365\370\312\125\136\022\013\373\024\135\172\057\152\244\221"
	"\140\223\166\326\217\141\127\072\201\124\251\255\061\116\276\127"
	"\204\164\232\337\110\133\100\146\162\312\350\136\357\313\353\210"
	"\370\376\234\353\247\202\104\136\150\253\000\012\132\344\250\226"
	"\355\367\034\224\054\300\266\001\205\127\303\001\003\331\165\322"
	"\156\166\116\311\074\324\151\161\347\055\124\227\247\071\055\255"
	"\013\320\167\231\025\244\204\136\052\273\036\220\002\011\307\055"
	"\307\140\066\126\331\156\055\341\075\110\261\144\156\252\152\372"
	"\306\036\135\171\131\343\135\137\233\054\215\125\031\164\237\365"
	"\364\057\075\317\357\313\026\054\036\353\051\323\177\021\224\307"
	"\364\360\041\026\123\260\031\326\064\250\162\355\366\261\273\304"
	"\335\000\277\371\273\115\004\340\175\225\003\326\244\036\073\373"
	"\021\353\376\104\335\323\010\332\247\002\212\142\034\110\213\334"
	"\151\067\275\072\004\074\234\032\062\216\005\040\054\074\032\327"
	"\012\013\311\106\352\315\255\165\323\117\222\076\020\172\057\060"
	"\174\336\154\361\207\015\265\133\167\316\247\031\173\377\217\105"
	"\054\224\046\142\257\330\215\362\256\345\040\105\076\224\212\362"
	"\317\026\176\241\266\053\126\051\127\356\215\100\167\301\322\337"
	"\112\345\202\156\022\340\270\202\362\232\201\311\265\076\214\240"
	"\200\077\341\064\336\355\304\013\377\252\361\130\023\247\004\074"
	"\373\277\004\166\032\174\143\347\061\273\064\205\051\050\231\035"
	"\062\166\370\363\205\077\151\262\075\071\174\035\251\122\374\030"
	"\055\151\200\150\340\063\143\327\164\243\046\115\017\226\047\153"
	"\311\206\313\370\167\030\033\020\366\235\006\201\010\265\330\221"
	"\274\313\107\170\125\150\211\333\215\012\302\201\056\232\261\060"
	"\267\114\172\261\213\113\333\121\142\313\307\365\257\357\277\062"
	"\221\271\250\134\314\361\363\212\276\031\054\103\065\062\253\307"
	"\160\377\366\215\335\323\375\152\131\113\261\177\204\212\117\305"
	"\323\322\304\244\131\375\223\167\050\174\174\030\272\371\256\025"
	"\026\074\206\004\027\337\315\307\347\334\313\072\231\165\214\250"
	"\304\015\370\342\335\004\031\076\331\326\360\350\355\023\322\315"
	"\271\061\354\351\240\143\262\164\122\342\026\142\106\070\157\346"
	"\005\266\325\227\312\031\140\077\032\131\215\253\352\030\070\360"
	"\163\151\335\255\002\026\141\076\166\077\020\206\064\030\246\136"
	"\105\337\056\156\202\116\125\232\322\072\250\303\263\210\323\061"
	"\245\245\107\145\037\372\356\371\214\141\172\234\371\346\101\046"
	"\262\322\010\365\162\070\117\355\352\321\105\212\124\173\223\057"
	"\033\233\214\303\257\170\024\364\142\074\060\260\333\164\235\262"
	"\203\265\320\021\137\044\173\105\367\172\322\145\271\354\236\046"
	"\213\376\240\042\145\242\042\015\147\262\224\021\205\377\321\107"
	"\122\147\007\203\023\331\367\244\121\047\124\323\002\014\210\077"
	"\030\347\252\137\073\302\003\150\056\272\350\354\262\116\301\000"
	"\031\232\244\147\021\370\044\101\375\116\212\370\053\074\112\310"
	"\200\324\017\103\300\031\263\357\212\023\055\376\352\047\211\004"
	"\243\340\005\170\115\207\234\340\145\112\202\304\215\044\050\047"
	"\067\220\123\126\366\055\312\264\045\164\103\305\263\075\264\364"
	"\247\117\103\166\345\110\377\141\346\131\203\363\052\231\303\113"
	"\112\351\323\340\072\340\073\176\062\364\153\171\200\056\226\255"
	"\271\244\114\257\126\134\005\131\047\242\115\344\360\117\306\265"
	"\061\044\163\065\310\061\015\057\260\036\322\270\350\306\316\334"
	"\113\202\255\112\046\316\004\114\153\136\077\112\260\107\006\150"
	"\363\132\137\260\346\021\073\165\167\241\335\143\103\116\145\126"
	"\234\256\045\304\107\056\365\026\242\353\252\371\314\111\032\030"
	"\111\314\315\171\113\164\001\125\151\117\120\146\217\360\330\061"
	"\260\016\101\107\042\026\312\225\245\341\153\137\335\217\301\311"
	"\331\142\115\142\016\224\065\206\377\057\025\340\122\073\251\143"
	"\365\376\261\311\172\031\056\002\225\150\363\274\075\220\115\121"
	"\277\251\374\307\030\020\305\320\266\210\177\320\111\271\220\033"
	"\032\050\255\335\275\017\234\272\272\161\135\243\032\372\226\013"
	"\157\277\254\110\275\305\023\361\156\124\167\055\125\323\265\112"
	"\150\316\334\171\046\237\021\342\054\255\165\071\332\310\176\010"
	"\276\135\301\141\137\035\047\321\232\200\371\006\153\263\045\100"
	"\044\054\141\177\371\055\100\222\125\366\012\076\310\041\121\043"
	"\275\174\351\255\204\352\062\354\020\267\227\263\156\127\172\167"
	"\074\223\006\250\217\127\000\265\142\054\354\323\012\243\070\320"
	"\276\177\045\157\212\313\167\341\350\353\305\071\062\375\274\057"
	"\102\224\213\222\310\362\103\012\320\254\255\244\177\203\002\207"
	"\343\312\355\376\305\360\220\306\124\366\323\017\241\213\366\060"
	"\057\066\007\161\160\030\006\272\065\036\315\262\272\322\344\340"
	"\166\166\260\341\307\355\171\216\026\212\176\176\112\326\022\121"
	"\072\214\037\352\210\237\301\003\077\177\274\343\332\271\131\063"
	"\020\101\135\237\215\343\123\354\123\051\167\246\041\327\260\203"
	"\040\331\154\251\245\204\346\007\246\116\326\245\345\346\005\062"
	"\373\367\072\356\007\022\132\132\107\125\131\010\344\012\003\327"
	"\302\030\060\123\034\336\246\114\130\352\141\224\312\232\121\142"
	"\035\125\162\152\357\356\255\361\155\006\243\126\337\132\211\271"
	"\311\340\106\004\321\106\334\031\033\117\250\033\366\051\366\155"
	"\237\044\365\104\375\047\206\156\060\222\315\105\113\011\145\247"
	"\112\134\172\107\207\004\051\230\042\161\040\276\274\224\031\051"
	"\353\173\037\201\371\130\363\036\174\362\015\121\352\147\044\014"
	"\142\036\223\103\126\176\321\203\237\052\067\151\131\125\250\141"
	"\242\124\252\055\046\152\347\217\216\275\265\142\160\313\116\256"
	"\017\173\105\016\205\223\050\166\226\214\371\115\154\067\030\036"
	"\036\031\244\274\303\004\231\265\135\155\141\232\155\120\020\075"
	"\337\070\205\141\163\134\315\154\262\177\047\323\120\061\366\241"
	"\316\357\122\113\267\226\225\354\014\214\166\147\114\033\325\052"
	"\325\322\211\154\221\073\364\172\257\302\056\024\356\030\070\116"
	"\135\257\243\110\240\344\312\153\213\116\104\074\047\153\312\317"
	"\201\147\232\373\270\263\314\234\061\233\030\332\154\330\226\102"
	"\041\315\254\020\243\060\172\050\047\136\262\236\065\047\202\121"
	"\377\363\277\134\160\240\364\332\166\054\156\030\201\060\145\331"
	"\050\075\334\066\061\266\025\216\160\105\354\376\160\272\324\330"
	"\270\310\126\122\176\202\351\224\304\211\102\157\110\261\006\034"
	"\016\112\021\244\153\024\215\353\242\043\145\016\162\044\123\033"
	"\357\156\071\346\161\375\200\213\046\273\312\111\027\160\134\364"
	"\042\023\375\203\032\073\170\245\205\063\141\217\322\337\110\072"
	"\357\115\151\043\345\106\262\104\047\120\333\134\114\301\074\223"
	"\307\365\203\326\247\215\004\275\357\363\131\205\001\225\203\321"
	"\236\153\251\102\311\253\126\244\332\157\361\103\133\136\205\256"
	"\323\065\133\254\360\222\144\306\377\357\027\131\121\154\151\004"
	"\236\246\272\241\323\215\303\030\343\350\247\206\050\267\366\311"
	"\371\071\155\065\025\365\305\127\124\336\130\142\376\173\253\100"
	"\334\227\027\300\237\043\305\345\021\214\147\040\321\221\053\112"
	"\001\275\323\060\361\301\025\067\251\202\330\260\015\222\312\242"
	"\247\042\211\122\347\043\076\237\310\041\020\171\350\171\365\161"
	"\324\162\376\121\365\230\076\001\216\015\136\141\330\153\300\337"
	"\331\266\270\236\256\224\220\036\236\132\127\145\361\027\217\303"
	"\047\053\004\227\040\313\204\155\252\276\354\044\320\234\246\024"
	"\134\301\074\146\272\134\320\200\241\326\326\106\004\305\127\324"
	"\307\035\120\070\201\301\327\137\027\230\235\275\150\067\225\257"
	"\034\062\161\066\355\327\233\217\300\010\254\132\327\114\312\063"
	"\277\364\366\124\033\243\046\054\334\371\350\276\264\122\035\246"
	"\357\065\031\354\145\250\077\201\070\362\271\070\144\171\242\237"
	"\220\134\025\360\351\360\266\145\256\071\012\361\067\026\242\106"
	"\212\017\237\103\030\312\245\170\177\274\374\046\221\370\050\332"
	"\010\174\000\044\271\347\155\065\117\170\355\144\373\335\007\262"
	"\043\037\333\122\274\305\244\365\247\373\105\343\356\312\004\217"
	"\303\310\036\373\265\075\055\322\257\036\153\165\151\004\106\365"
	"\333\055\246\247\354\314\153\322\330\250\373\220\125\063\060\144"
	"\305\304\113\104\304\144\073\374\006\371\005\262\071\377\037\056"
	"\020\132\161\241\110\325\064\112\145\222\136\204\305\337\316\111"
	"\043\067\216\114\150\254\264\160\154\016\123\253\013\047\147\164"
	"\102\255\005\347\202\360\313\231\167\050\303\115\256\372\002\027"
	"\105\303\275\306\225\125\106\253\205\366\324\352\063\121\071\311"
	"\114\114\200\230\271\011\204\177\321\333\127\132\217\362\240\243"
	"\134\370\077\201\004\335\242\223\375\235\251\141\162\116\347\076"
	"\036\203\011\205\120\240\326\210\113\037\215\301\237\126\216\275"
	"\146\014\142\115\006\377\201\230\300\170\353\233\215\363\327\053"
	"\052\141\324\041\275\112\251\233\152\125\146\354\070\062\243\141"
	"\005\040\375\002\372\142\075\050\116\216\001\005\017\075\123\052"
	"\130\125\171\356\352\305\071\356\342\016\015\213\036\045\010\314"
	"\337\061\040\376\077\021\131\260\372\101\021\254\117\012\336\147"
	"\372\333\256\356\206\221\136\042\205\141\340\163\023\302\070\377"
	"\175\171\363\040\056\343\226\017\245\024\102\020\317\152\370\106"
	"\044\370\273\355\041\350\221\053\202\215\346\163\066\305\351\126"
	"\302\276\210\057\043\137\044\202\237\204\017\243\307\204\043\232"
	"\044\064\256\327\047\101\201\242\150\067\126\117\353\036\221\144"
	"\350\200\001\344\165\022\124\101\370\020\205\114\371\103\014\152"
	"\053\326\002\064\101\101\212\114\234\012\305\043\211\311\003\310"
	"\244\312\143\356\167\350\330\026\337\211\025\065\117\276\060\023"
	"\116\023\144\022\353\225\042\353\244\255\224\336\325\027\151\216"
	"\153\252\326\221\325\116\200\117\343\056\013\046\142\170\303\227"
	"\275\211\305\053\251\132\311\043\146\354\117\322\135\217\123\100"
	"\110\033\161\072\133\147\011\313\372\153\315\134\155\341\352\130"
	"\123\025\005\113\276\142\177\271\157\375\164\214\134\140\363\304"
	"\340\370\161\116\012\263\136\372\364\242\251\074\245\143\145\301"
	"\325\206\212\021\265\227\166\136\071\372\247\372\131\153\215\313"
	"\042\137\002\211\032\201\011\254\204\022\370\173\136\246\157\233"
	"\332\123\136\153\147\256\016\121\311\374\250\136\274\220\350\002"
	"\353\174\012\050\352\071\255\047\103\021\042\207\035\247\104\210"
	"\011\071\053\157\375\362\075\266\110\137\023\146\027\121\110\133"
	"\143\135\172\327\033\171\052\221\143\306\375\162\076\262\077\214"
	"\021\325\212\231\063\212\370\075\173\247\256\125\331\261\255\011"
	"\303\310\307\023\143\162\335\061\043\314\373\017\011\146\371\155"
	"\051\165\131\270\202\030\143\140\337\372\315\145\173\147\037\134"
	"\150\103\023\251\240\305\122\155\203\044\157\201\154\016\063\327"
	"\264\243\060\231\341\261\070\071\377\051\332\066\030\276\152\276"
	"\074\011\247\012\052\264\062\303\134\350\236\061\320\101\375\376"
	"\261\171\150\244\360\341\212\305\033\124\022\364\030\050\042\175"
	"\235\072\302\177\026\047\356\164\255\324\102\200\040\150\161\376"
	"\147\205\207\172\253\352\100\000\002\060\361\354\157\171\054\351"
	"\213\217\224\216\126\140\035\016\211\157\061\211\346\203\176\071"
	"\355\152\072\162\047\044\045\151\167\265\271\011\235\057\335\010"
	"\100\034\143\300\204\111\323\274\146\131\160\011\014\236\156\363"
	"\201\263\043\042\045\050\315\112\365\063\367\330\250\057\231\241"
	"\102\273\053\165\162\326\324\320\074\244\036\162\253\224\112\137"
	"\055\256\007\272\251\125\021\140\233\003\027\267\256\365\271\145"
	"\003\367\277\342\052\116\051\165\203\147\267\336\163\145\105\351"
	"\130\112\067\044\134\160\077\132\041\241\277\050\151\320\240\053"
	"\051\355\217\173\322\376\013\204\237\320\060\073\045\171\274\307"
	"\153\356\150\305\156\333\345\304\307\233\353\333\255\331\040\210"
	"\062\070\046\130\333\175\370\176\062\176\373\156\365\100\027\163"
	"\240\346\015\230\077\222\112\025\301\375\233\013\074\374\205\315"
	"\311\016\235\272\117\247\106\153\103\334\235\323\135\072\336\042"
	"\212\237\132\124\036\062\060\155\163\056\125\025\063\302\100\375"
	"\117\246\333\242\214\141\131\117\337\232\113\263\310\051\276\143"
	"\146\131\231\215\353\147\213\141\305\204\164\107\165\057\175\065"
	"\223\362\303\072\347\163\246\305\032\237\157\173\174\216\103\162"
	"\333\070\223\340\001\103\261\326\331\156\000\223\322\265\005\277"
	"\244\356\172\323\132\244\045\260\155\202\257\376\122\051\325\063"
	"\141\322\370\275\316\116\123\111\366\266\023\334\137\134\143\263"
	"\015\074\007\015\101\320\160\332\002\146\112\270\276\025\220\250"
	"\053\237\021\355\204\137\072\144\043\036\244\036\312\303\145\021"
	"\140\232\166\004\241\340\215\173\313\103\241\261\015\372\342\136"
	"\261\026\117\345\302\352\035\351\234\054\222\231\127\077\140\023"
	"\252\162\145\127\347\163\200\126\041\230\345\260\163\120\040\331"
	"\237\210\230\226\050\264\326\330\223\302\207\102\254\046\014\072"
	"\045\351\175\020\053\240\124\116\236\137\234\021\367\024\107\000"
	"\123\306\364\305\124\267\366\212\336\306\246\241\031\367\116\217"
	"\142\002\037\137\224\052\212\304\120\045\200\105\002\261\227\100"
	"\203\217\027\155\235\305\147\007\303\301\131\110\251\031\277\141"
	"\147\203\161\376\331\122\160\313\144\337\244\374\175\301\160\367"
	"\333\104\213\342\037\200\024\040\250\251\020\114\031\351\106\001"
	"\326\015\207\335\056\014\152\066\174\332\227\235\116\065\016\005"
	"\043\262\306\252\257\164\053\172\214\365\173\163\070\267\353\252"
	"\073\246\171\031\172\075\301\044\310\222\012\162\243\112\344\035"
	"\072\251\027\121\041\253\051\346\122\043\070\256\242\036\130\212"
	"\347\175\367\067\211\127\033\214\247\225\106\257\010\073\156\257"
	"\036\242\136\326\151\216\072\170\371\313\272\030\052\112\147\221"
	"\120\114\340\260\245\257\003\363\272\236\062\072\226\177\124\320"
	"\155\364\333\346\134\237\133\107\256\200\147\074\350\246\154\050"
	"\214\044\162\042\212\065\247\045\137\321\017\071\226\212\265\143"
	"\213\151\112\233\354\270\267\056\134\005\054\251\117\320\230\055"
	"\337\105\315\353\020\373\002\130\257\041\337\231\344\366\133\121"
	"\111\001\056\031\277\170\226\024\167\220\146\240\233\177\256\136"
	"\254\206\265\356\231\111\356\156\077\336\324\156\110\040\305\102"
	"\306\315\220\266\035\202\332\160\202\155\357\322\242\224\246\143"
	"\056\331\202\370\334\126\055\077\377\053\367\347\035\300\173\300"
	"\013\117\116\343\005\067\303\333\134\362\253\135\024\111\264\170"
	"\004\241\102\004\176\036\207\026\121\175\175\124\367\157\144\010"
	"\146\224\156\035\231\131\343\252\137\260\345\217\311\002\323\332"
	"\152\340\112\056\056\274\164\050\155\255\040\321\221\317\250\010"
	"\031\343\274\024\250\211\103\274\246\227\120\005\325\343\173\155"
	"\312\114\127\065\235\300\300\272\200\001\147\036\265\251\102\057"
	"\054\066\334\163\227\311\242\234\366\237\037\127\255\225\110\260"
	"\103\300\205\336\171\142\324\022\260\274\043\030\341\364\127\122"
	"\014\133\100\155\131\116\253\122\257\220\201\312\327\045\307\373"
	"\273\311\027\133\132\262\343\247\354\016\214\174\072\250\046\077"
	"\242\330\106\202\272\311\022\236\074\013\126\213\257\356\207\254"
	"\207\116\366\045\250\043\334\355\023\233\355\074\356\142\237\115"
	"\161\165\136\203\234\000\166\034\077\205\225\162\203\230\056\251"
	"\200\130\347\203\343\124\076\122\154\265\345\217\341\032\364\343"
	"\063\154\366\222\213\100\243\125\005\111\133\330\166\101\322\240"
	"\352\025\112\367\135\034\253\045\305\145\024\111\023\150\121\157"
	"\255\324\305\275\221\143\275\142\126\114\063\024\054\302\137\100"
	"\207\311\052\163\267\064\041\343\336\230\362\374\275\242\161\202"
	"\146\330\355\323\065\173\062\075\351\264\237\161\240\010\152\101"
	"\103\112\124\007\354\365\223\134\163\356\216\214\105\222\262\163"
	"\304\165\277\223\064\033\312\066\034\165\125\045\251\323\147\031"
	"\375\363\150\317\076\073\103\264\222\170\231\376\012\310\107\055"
	"\275\033\227\034\161\307\312\136\302\140\204\273\260\053\001\037"
	"\250\220\263\107\017\341\051\136\200\330\344\257\126\351\254\322"
	"\355\154\130\210\216\025\147\024\053\001\275\312\057\274\140\262"
	"\237\350\066\103\231\256\141\163\240\244\131\047\037\120\071\252"
	"\370\025\154\053\053\077\302\141\331\020\377\053\132\012\207\002"
	"\006\124\170\224\042\231\275\232\105\301\132\213\126\274\074\032"
	"\001\332\037\135\223\222\164\016\052\326\065\203\216\130\340\315"
	"\163\054\065\317\152\150\335\117\277\142\346\152\261\240\250\157"
	"\167\315\035\317\036\172\115\361\065\047\041\361\366\104\037\100"
	"\043\254\130\306\024\066\025\324\231\374\076\113\234\347\272\024"
	"\264\330\344\323\123\061\305\211\131\346\172\117\052\232\220\116"
	"\107\351\024\133\037\052\060\270\046\156\003\303\125\276\327\012"
	"\226\274\336\352\355\243\163\106\211\355\226\263\210\046\002\317"
	"\017\026\053\057\100\133\350\146\312\353\052\037\252\002\052\100"
	"\276\011\052\253\255\236\361\067\213\210\352\023\256\355\342\276"
	"\003\016\355\103\151\326\252\063\301\324\123\154\326\176\255\224"
	"\207\327\100\064\166\062\153\001\272\126\025\151\103\370\047\107"
	"\006\025\212\157\353\065\243\255\012\366\032\340\164\307\165\374"
	"\237\265\061\025\350\235\026\242\364\054\013\067\044\063\177\052"
	"\111\011\232\065\077\075\343\111\064\375\052\251\304\240\246\143"
	"\126\327\170\076\164\216\340\150\273\354\240\337\037\037\012\150"
	"\051\245\235\150\343\200\262\027\175\335\301\102\175\147\245\324"
	"\076\035\022\263\254\362\033\147\337\274\106\376\333\121\147\005"
	"\366\005\156\331\206\040\361\004\376\262\106\173\032\353\117\130"
	"\010\142\014\264\125\047\034\064\344\143\062\300\264\232\305\252"
	"\237\063\204\045\124\166\052\122\050\160\316\103\133\036\234\144"
	"\200\250\031\326\320\065\012\264\230\075\164\114\327\071\367\167"
	"\155\174\235\302\362\307\024\033\067\343\136\223\001\372\367\202"
	"\243\021\130\163\106\143\047\337\240\234\053\167\326\043\357\104"
	"\240\214\006\222\123\033\255\213\376\014\036\000\007\025\203\252"
	"\047\333\035\155\076\105\114\337\342\170\127\270\234\106\374\074"
	"\322\003\316\046\036\174\261\034\211\317\035\220\345\240\072\014"
	"\174\130\172\272\235\306\232\200\077\361\071\333\067\065\027\012"
	"\071\346\061\127\143\342\164\354\262\221\175\230\061\267\244\255"
	"\020\037\150\256\346\002\056\045\364\147\000\053\235\030\066\326"
	"\377\147\056\142\112\242\117\374\063\314\224\145\204\071\022\224"
	"\130\173\102\076\175\160\144\161\327\145\235\165\175\324\113\175"
	"\074\171\340\206\033\057\203\117\373\027\264\200\121\307\024\252"
	"\102\126\350\300\307\115\062\237\262\317\024\060\244\137\255\340"
	"\331\215\146\365\275\351\105\271\001\371\071\123\300\115\375\003"
	"\244\346\303\153\063\365\012\345\305\037\026\151\177\303\111\130"
	"\121\260\116\017\232\223\310\234\215\002\357\115\120\354\121\364"
	"\322\024\140\006\011\153\354\317\212\002\070\011\305\202\142\027"
	"\063\260\046\315\104\356\152\321\361\131\037\101\106\160\065\031"
	"\204\226\037\216\001\013\136\213\015\226\225\323\031\367\353\114"
	"\250\021\032\354\000\205\275\361\336\335\062\044\115\150\076\322"
	"\376\135\141\000\151\277\213\167\126\040\112\157\030\065\274\300"
	"\107\327\254\107\134\152\071\073\107\154\140\225\324\236\150\323"
	"\373\312\323\145\211\136\334\340\177\047\120\230\135\015\130\244"
	"\344\005\354\101\157\045\174\267\222\334\115\146\172\266\071\166"
	"\200\014\333\012\153\267\352\353\336\073\203\074\110\333\340\054"
	"\341\315\156\120\363\352\010\205\307\126\353\101\014\045\267\214"
	"\062\223\227\236\113\201\211\052\275\015\146\005\351\107\062\312"
	"\024\240\033\007\212\043\215\121\171\171\223\206\236\113\023\321"
	"\336\252\157\051\054\370\123\351\006\272\356\357\001\040\271\025"
	"\301\324\035\113\367\253\235\161\044\061\370\303\174\013\224\133"
	"\265\003\205\341\374\331\313\002\223\271\361\224\332\253\252\233"
	"\177\310\347\167\163\205\351\227\266\341\133\062\354\357\215\242"
	"\363\023\204\360\354\117\363\177\011\345\024\343\220\276\177\017"
	"\207\146\206\372\353\157\222\242\121\355\324\076\335\142\340\320"
	"\165\145\301\141\265\264\341\276\232\365\242\052\264\041\071\073"
	"\210\300\065\164\060\310\026\202\265\353\300\223\115\241\144\303"
	"\006\045\045\273\332\006\172\164\374\034\236\260\076\330\353\306"
	"\231\041\072\311\351\121\113\237\074\014\063\212\255\227\115\264"
	"\274\162\160\227\171\352\013\165\006\252\045\104\202\021\013\033"
	"\062\106\345\034\227\060\274\324\074\357\136\352\207\253\236\103"
	"\036\016\333\227\371\346\014\377\220\061\104\023\103\117\057\166"
	"\225\024\222\055\105\117\001\202\077\137\155\306\013\013\012\051"
	"\032\345\300\023\314\314\023\135\376\127\160\101\247\240\267\074"
	"\265\112\152\372\232\153\175\332\313\352\240\326\366\253\377\020"
	"\220\300\044\135\215\067\272\214\216\053\316\066\313\206\162\200"
	"\321\335\173\153\110\371\105\023\344\346\352\332\221\352\353\042"
	"\252\017\177\070\107\071\305\326\145\223\014\061\031\177\262\352"
	"\134\055\126\245\047\234\271\013\202\243\346\024\215\321\066\070"
	"\341\266\161\050\360\066\377\125\311\013\206\343\213\070\316\347"
	"\146\044\214\216\301\105\231\104\351\177\130\166\121\217\257\063"
	"\105\040\134\065\127\133\212\040\147\021\004\362\111\322\331\260"
	"\367\146\076\270\254\330\374\225\130\125\014\251\344\273\334\051"
	"\334\071\137\063\224\352"
#define      xecc_z	15
#define      xecc	((&data[6836]))
	"\130\356\105\274\045\031\021\033\106\354\303\172\313\052\125\105"
	"\356\226\052\310\366"
#define      lsto_z	1
#define      lsto	((&data[6854]))
	"\115"
#define      tst2_z	19
#define      tst2	((&data[6859]))
	"\327\160\144\054\265\122\330\251\202\022\107\240\300\372\355\033"
	"\260\166\046\106\220\357\306"
#define      chk2_z	19
#define      chk2	((&data[6878]))
	"\344\012\220\042\014\035\244\053\016\366\050\275\040\254\047\323"
	"\266\371\111"
#define      pswd_z	256
#define      pswd	((&data[6956]))
	"\024\044\232\107\271\204\233\265\200\363\243\305\036\153\273\100"
	"\232\360\033\165\375\362\345\142\036\141\160\057\230\133\152\254"
	"\200\005\364\071\212\220\356\012\203\221\317\242\375\213\342\227"
	"\174\375\014\171\360\361\333\017\123\114\077\340\064\337\124\023"
	"\111\241\224\242\014\033\034\010\043\335\046\362\331\147\140\344"
	"\143\201\274\145\050\034\063\204\330\212\145\015\151\271\041\263"
	"\133\266\126\147\321\162\160\365\120\226\350\051\375\110\016\140"
	"\312\312\306\362\346\371\166\277\204\334\315\356\225\356\242\360"
	"\244\370\130\166\153\310\153\274\137\123\346\134\234\364\275\146"
	"\276\204\131\245\176\320\144\002\254\061\361\101\040\223\062\304"
	"\214\212\073\370\123\246\264\262\372\232\017\226\216\314\375\115"
	"\120\126\362\316\046\126\321\322\210\303\024\250\127\106\155\343"
	"\321\250\333\044\117\220\326\111\052\345\340\271\262\335\006\003"
	"\063\370\322\132\117\243\054\327\147\100\200\276\207\355\242\130"
	"\226\176\174\345\016\123\057\071\071\020\362\353\355\370\357\041"
	"\361\301\173\100\145\247\027\314\350\227\213\157\205\055\310\034"
	"\253\104\002\271\230\061\362\321\102\345\275\057\335\254\121\316"
	"\156\314\016\323\164\046\240\135\276\053\315\104\131\225\140\004"
	"\332\142\275\162\224\260\104\326\225\002\006\163\257\127\102\035"
	"\044\120\361\230\167\222\366\066\276\303\172\354\250\252\231\050"
	"\257\215\142\071\035\120\103\241\342"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
